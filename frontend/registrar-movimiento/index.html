<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Registrar movimiento</title>
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <!-- Auth Container (Login/Register) -->
  <div id="authContainer" class="card">
    <header class="header">
      <h1>Gastos</h1>
      <p class="subtitle">Inicia sesión para continuar</p>
    </header>

    <!-- Login Form -->
    <form id="loginForm" class="auth-form">
      <div class="grid">
        <label class="field col-span-2">
          <span>Email</span>
          <input type="email" id="loginEmail" placeholder="tu@email.com" required />
        </label>

        <label class="field col-span-2">
          <span>Contraseña</span>
          <input type="password" id="loginPassword" placeholder="••••••••" required />
        </label>
      </div>

      <p id="loginError" class="error-message hidden"></p>

      <div class="footer">
        <button type="submit">Iniciar sesión</button>
        <p class="auth-switch">
          ¿No tienes cuenta? <a href="#" id="showRegister">Regístrate</a>
        </p>
      </div>
    </form>

    <!-- Register Form -->
    <form id="registerForm" class="auth-form hidden">
      <div class="grid">
        <label class="field col-span-2">
          <span>Email</span>
          <input type="email" id="registerEmail" placeholder="tu@email.com" required />
        </label>

        <label class="field col-span-2">
          <span>Contraseña</span>
          <input type="password" id="registerPassword" placeholder="Mínimo 8 caracteres" required />
        </label>

        <label class="field col-span-2">
          <span>Confirmar contraseña</span>
          <input type="password" id="registerConfirm" placeholder="••••••••" required />
        </label>
      </div>

      <p id="registerError" class="error-message hidden"></p>

      <div class="footer">
        <button type="submit">Registrarse</button>
        <p class="auth-switch">
          ¿Ya tienes cuenta? <a href="#" id="showLogin">Inicia sesión</a>
        </p>
      </div>
    </form>
  </div>

  <!-- App Container (Movement Form) -->
  <main id="appContainer" class="card hidden">
    <header class="header">
      <div class="header-row">
        <h1>Registrar movimiento</h1>
        <div class="user-info">
          <span id="userEmail" class="user-email"></span>
          <button type="button" id="logoutBtn" class="logout-btn">Salir</button>
        </div>
      </div>
      <p class="subtitle">Gasto familiar, gasto compartido o pago de deuda.</p>
    </header>

    <form id="movForm" novalidate>
      <div class="grid">
        <label class="field">
          <span>Fecha</span>
          <input name="fecha" id="fecha" type="date" required />
          <small class="hint">Obligatorio</small>
        </label>

        <label class="field">
          <span>Tipo de movimiento</span>
          <select name="tipo" id="tipo" required>
            <option value="" selected disabled>Seleccionar</option>
            <option value="FAMILIAR">Gasto familiar</option>
            <option value="COMPARTIDO">Gasto compartido</option>
            <option value="PAGO_DEUDA">Pago deuda</option>
          </select>
          <small class="hint">Obligatorio</small>
        </label>

        <label class="field col-span-2">
          <span>Descripción</span>
          <input name="descripcion" id="descripcion" type="text" placeholder="Ej: Almuerzo, Uber a casa, Guaritos…" required />
          <small class="hint">Opcional</small>
        </label>

        <label class="field col-span-2">
          <span>Categoría</span>
          <select name="categoria" id="categoria" required>
            <option value="" selected disabled>Seleccionar</option>
          </select>
          <small class="hint">Obligatorio</small>
        </label>

        <label class="field col-span-2">
          <span>Monto total (COP)</span>
          <input name="valor" id="valor" type="number" min="0" step="1" inputmode="numeric" placeholder="0" required />
          <small class="hint">Obligatorio</small>
        </label>

        <!-- Pagador y Tomador en fila (para PAGO_DEUDA) -->
        <div class="field-row col-span-2 hidden" id="pagadorTomadorRow">
          <label class="field">
            <span id="pagadorLabel">¿Quién pagó?</span>
            <select name="pagador" id="pagador"></select>
          </label>
          <label class="field">
            <span>¿Quién recibió?</span>
            <select name="tomador" id="tomador"></select>
          </label>
        </div>

        <!-- Pagador solo (para COMPARTIDO) -->
        <label class="field hidden" id="pagadorWrap">
          <span>¿Quién pagó?</span>
          <select name="pagadorCompartido" id="pagadorCompartido"></select>
          <small class="hint">Obligatorio</small>
        </label>

        <!-- Método de pago -->
        <div class="field col-span-2 hidden" id="metodoWrap">
          <span>Método de pago</span>
          <select name="metodo" id="metodo">
            <option value="" selected>Seleccionar</option>
          </select>
        </div>

        <!-- Participantes: solo para COMPARTIDO -->
        <section class="section col-span-2 hidden" id="participantesWrap">
          <div class="sectionHeader">
            <h2>Participantes</h2>
            <label class="checkbox">
              <input type="checkbox" id="equitable" checked />
              <span>Dividir equitativamente</span>
            </label>
          </div>

          <div id="participantsList" class="participantsList"></div>

          <div class="actionsRow">
            <button type="button" class="secondary" id="addParticipantBtn">Agregar participante</button>
          </div>

          <p class="note">
            Si no es equitativo, puedes editar los porcentajes. La suma debe ser 100%.
          </p>
        </section>
      </div>

      <div class="footer">
        <button type="submit" id="submitBtn">Registrar</button>
        <p id="status" class="status" role="status" aria-live="polite"></p>
      </div>
    </form>
  </main>

  <script src="./auth.js"></script>
  <script src="./app.js"></script>
</body>
</html>
